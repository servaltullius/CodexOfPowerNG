# Codex of Power NG v1.0.6-rc.6 (2026-02-17, Pre-release)

## 요약
이번 프리릴리즈는 C++ 런타임 코드를 역할 단위로 추가 모듈화하고, 리팩터링 회귀를 막기 위한 호스트 테스트를 보강하는 데 집중했습니다.  
게임플레이/UI 동작 변경 없이 유지보수성과 검증 가능성을 높였습니다.

## 주요 변경점
- Prisma UI payload 빌더를 인벤토리/보상 단위로 분리
- Registration 내부 로직을 `core/maps/tcc` 책임으로 분리
- Serialization 경로를 `install/save/load` 책임으로 분리
- FormID 파싱/로컬 변환 경계값 테스트 추가
- Save writer 실행 흐름(앞 단계 실패 후에도 후속 writer 실행) 회귀 테스트 추가

## 사용자 영향
- 기능 동작 변화 없음
- 설정/저장 포맷 변경 없음
- 모드 요구사항/선행모드 증가 없음

## 기술 변경 상세
- 빌드 그래프:
  - `CMakeLists.txt`
- Prisma UI payload 분리:
  - `src/PrismaUIPayloads.cpp` (삭제)
  - `src/PrismaUIPayloads.h`
  - `src/PrismaUIPayloadsInventory.cpp` (신규)
  - `src/PrismaUIPayloadsRewards.cpp` (신규)
- Registration 내부 분리:
  - `src/RegistrationInternal.cpp`
  - `src/RegistrationInternalMaps.cpp` (신규)
  - `src/RegistrationInternalTcc.cpp` (신규)
  - `src/RegistrationInternal.h`
  - `include/CodexOfPowerNG/RegistrationFormId.h` (신규)
- Serialization 내부 분리:
  - `src/Serialization.cpp`
  - `src/SerializationInternal.h` (신규)
  - `src/SerializationSave.cpp` (신규)
  - `src/SerializationLoad.cpp` (신규)
  - `include/CodexOfPowerNG/SerializationWriteFlow.h` (신규)
- Prisma UI/Settings/Request/View 관련 분리 파일:
  - `src/PrismaUIInternal.h` (신규)
  - `src/PrismaUIRequests.cpp` (신규)
  - `src/PrismaUIRequestOps.cpp` / `src/PrismaUIRequestOps.h` (신규)
  - `src/PrismaUISettings.cpp` / `src/PrismaUISettingsInternal.h` / `src/PrismaUISettingsPayload.cpp` (신규)
  - `src/PrismaUIStatePayload.cpp` (신규)
  - `src/PrismaUIToggleActions.cpp` / `src/PrismaUITogglePolicy.cpp` (신규)
  - `src/PrismaUIViewLifecycle.cpp` / `src/PrismaUIViewState.cpp` / `src/PrismaUIViewState.h` / `src/PrismaUIViewWorkers.cpp` (신규)
- Rewards/Registration 분리 파일:
  - `src/RegistrationQuickRegister.cpp` (신규)
  - `src/RewardsCore.cpp` / `src/RewardsRandomTables.cpp` / `src/RewardsInternal.h` (신규)
- 테스트:
  - `tests/quick_register_rules.test.cjs`
  - `tests/registration_formid_parse.test.cpp` (신규)
  - `tests/serialization_write_flow.test.cpp` (신규)

## 검증
- `cmake --build --preset wsl-release` 통과
- `./scripts/test.sh` 통과 (`JS 50/50`, `C++ host tests` 통과)
- `cmake --install build/wsl-release` 통과
- `python3 scripts/vibe.py doctor --full` 통과

## 호환성/주의사항
- 기존 Codex of Power / SVCollection과 저장 호환되지 않습니다.
- 런타임 요구사항은 기존과 동일합니다:
  - SKSE64
  - Address Library for SKSE Plugins
  - Prisma UI
  - Media Keys Fix SKSE
- 본 릴리즈는 구조 리팩터링 중심으로, 의도된 사용자 기능 변화는 없습니다.

## 패키지
- 태그: `v1.0.6-rc.6`
- 릴리즈: `https://github.com/servaltullius/CodexOfPowerNG/releases/tag/v1.0.6-rc.6`
- 에셋: `Codex.of.Power.NG.zip`
- 저장소 내 아카이브: `releases/Codex of Power NG.zip`
