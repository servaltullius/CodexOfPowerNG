# Codex of Power NG v1.0.7-rc.12 (2026-02-19, Pre-release)

## 요약
이번 프리릴리즈는 보상 동기화 안정화(치명타/저항 과상한, 소지무게 반영 누락)와 WSL 릴리즈 빌드 신뢰성 개선에 초점을 둔 수정 릴리즈입니다.  
로드 후 수치 재적용 과정에서의 과보정/누락을 줄이고, 설정 저장의 경계값 처리도 보강했습니다.

## 주요 변경점
- 캡이 있는 ActorValue 동기화에 보수적 보정 정책 추가
- 하드 캡 초과 상태를 감지하면 즉시 하향 보정하는 cap-guard 경로 추가
- `rewardMultiplier=0` 저장 시 `1.0`으로 강제되던 문제 수정
- Prisma UI Close 재시도에서 큐 실패 시 조기 종료하지 않고 정리/재시도 지속
- WSL `clang-cl` 릴리즈 빌드 include 경로 보강(`/usr/include/x86_64-linux-gnu`)
- Release 프리셋에서 C++ 테스트 타깃 자동 빌드 비활성화(`COPNG_BUILD_CPP_TEST_TARGETS=OFF`)

## 사용자 영향
- 치명타 확률/전기 저항 등 캡 대상 보상 수치가 과도하게 누적되는 현상이 완화됩니다.
- 소지무게 계열 동기화에서 로드 직후 누락/과보정 가능성이 줄어듭니다.
- Settings에서 보상 배수를 `0`으로 저장해도 값이 유지됩니다.
- 기능 사용 방식(핫키, UI 흐름, 보상 정책의 기본값)은 기존과 동일합니다.

## 기술 변경 상세
- 보상 동기화/캡 가드:
  - `include/CodexOfPowerNG/RewardsResync.h`
  - `src/Rewards.cpp`
- Close 재시도/큐 실패 처리 강화:
  - `src/PrismaUIViewWorkers.cpp`
- 설정 payload 파싱/저장 경계값:
  - `src/PrismaUISettingsPayload.cpp`
  - `PrismaUI/views/codexofpowerng/index.html`
- 요청 payload 진단 로그 강화:
  - `src/PrismaUIRequestOps.cpp`
- CMake 프리셋/옵션 분리:
  - `CMakeLists.txt`
  - `CMakePresets.json`
  - `cmake/toolchains/wsl-clangcl-vcpkg.cmake`
- 테스트 추가/강화:
  - `tests/rewards_resync.test.cpp`
  - `tests/reward_caps_policy.test.cjs`
  - `tests/settings_payload_validation.test.cjs`
- 운영 문서 정합성 갱신:
  - `AGENTS.md`

## 검증
- `python3 scripts/vibe.py doctor --full` 통과
- `scripts/test.sh` 통과 (`JS 60/60`, `C++ host tests` 통과)
- `export VCPKG_ROOT="/mnt/c/Users/kdw73/vcpkg" && cmake --preset wsl-release --fresh` 통과
- `cmake --build --preset wsl-release --verbose` 통과
- `cmake --install build/wsl-release` 통과
- `cd dist/CodexOfPowerNG && zip -r -FS "../../releases/Codex of Power NG.zip" .` 통과

## 호환성/주의사항
- Codex of Power / SVCollection과 저장 호환되지 않습니다.
- 런타임 요구사항은 기존과 동일합니다:
  - SKSE64
  - Address Library for SKSE Plugins
  - Prisma UI
  - Media Keys Fix SKSE

## 패키지
- 태그: `v1.0.7-rc.12`
- 릴리즈: `https://github.com/servaltullius/CodexOfPowerNG/releases/tag/v1.0.7-rc.12`
- 에셋: `Codex of Power NG.zip`
- 저장소 내 아카이브: `releases/Codex of Power NG.zip`
