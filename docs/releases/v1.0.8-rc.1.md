# Codex of Power NG v1.0.8-rc.1 (2026-02-21, Pre-release)

## 요약
이번 프리릴리즈는 보상/Undo 정합성, Quick Register 성능, 세이브 진단 가시성을 함께 개선한 안정화 업데이트입니다.
로드 직후 동기화 과비용을 줄이고, Undo 시 실제 적용된 보상 델타만 기록/롤백하도록 정리했습니다.

## 주요 변경점
- 보상 동기화 루프에 조기 수렴 종료 로직 추가 (불필요한 패스 실행 감소)
- Quick Register 목록에 짧은 TTL 캐시 + generation invalidation 도입
- 등록 시 Undo 보상 델타를 전체 before/after 스냅샷 diff가 아닌 실제 적용 델타 기반으로 기록
- Undo 롤백 0건 적용 시 경고 로그/메시지 추가
- Serialization save writer 실패 집계/보고 강화

## 사용자 영향
- 로드 직후 불필요한 동기화 반복이 줄어 프레임 저하 체감이 완화됩니다.
- 잘못 등록 후 Undo 시 보상 수치 롤백 정합성이 개선됩니다.
- 설정 저장/로드/Undo 이후 Quick Register 목록 갱신이 더 안정적으로 동작합니다.

## 기술 변경 상세
- 보상 동기화/정합성:
  - `src/Rewards.cpp`
  - `src/RewardsCore.cpp`
  - `src/RewardsInternal.h`
  - `include/CodexOfPowerNG/Rewards.h`
  - `include/CodexOfPowerNG/RewardsSyncPolicy.h`
- Quick Register 캐시:
  - `src/RegistrationQuickRegister.cpp`
  - `include/CodexOfPowerNG/Registration.h`
  - `src/PrismaUISettings.cpp`
  - `src/SerializationLoad.cpp`
  - `src/SerializationSave.cpp`
  - `src/RegistrationUndo.cpp`
- Save writer 실패 가시성:
  - `include/CodexOfPowerNG/SerializationWriteFlow.h`
  - `src/SerializationSave.cpp`
- 로컬라이제이션:
  - `SKSE/Plugins/CodexOfPowerNG/lang/en.json`
  - `SKSE/Plugins/CodexOfPowerNG/lang/ko.json`
- 테스트:
  - `tests/quick_register_cache.test.cjs` 추가
  - `tests/undo_registration_flow.test.cjs` 보강
  - `tests/serialization_write_flow.test.cpp` 보강
  - `tests/rewards_sync_policy.test.cpp` 보강

## 검증
- `./scripts/test.sh` : PASS (`JS 75/75`, `C++ host tests` 통과)
- `cmake --build --preset wsl-release` : PASS

## 호환성/주의사항
- 본 프로젝트는 구 버전 Codex of Power/SVCollection 세이브 마이그레이션을 목표로 하지 않습니다.
- Quick Register 캐시는 짧은 TTL + 이벤트 무효화 구조로 동작하며, 등록/Undo/로드/설정 변경 시 즉시 무효화됩니다.
- Undo 성공 시에도 롤백 대상 델타가 실제 actor 값에 적용되지 않은 경우 경고 문구가 추가될 수 있습니다.

## 패키지
- 배포 파일: `releases/Codex of Power NG.zip`
- 태그: `v1.0.8-rc.1`
- 릴리즈: https://github.com/servaltullius/CodexOfPowerNG/releases/tag/v1.0.8-rc.1
